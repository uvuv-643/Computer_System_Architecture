# Лабораторная работа №3. Транслятор и модель процессора

* P33121. Зинатулин Артём Витальевич
* ```forth | stack | harv | hw | tick | struct | trap | port | pstr | prob5 | spi```
* без усложнения

## Язык программирования

```

<процедура> →   ": " <название процедуры> <программа> " ;"

<программа> →   <пусто> | <слово> | <программа> " " <программа> | <условный оператор> |
                <оператор цикла do loop> | <оператор цикла begin until> <объявление переменной>
                
<объявление переменной> → "variable " <переменная> ["allot " <целочисленный литерал>] 

<условный оператор> → if <программа> [else <программаа>] then  

<оператор цикла do loop> → do <программа> loop  

<оператор цикла begin until> → begin <программа> until  

<слово> →   <целочисленный литерал> | <математический оператор> | <отображение строки> | <название процедуры> |
            "mod" | "drop" | "swap" | "over" | "dup" | "read" | "omit" | <переменная> | "@" | "!"

<математический оператор> → "+" | "-" | "*" | "/" | "invert" | "=" | "<" | ">" 

<отображение строки> → "." | "." <строковый литерал>

<комментарий> → "\" <строка>

```

Код выполняется последовательно за исключением процедур.
Вызов процедуры осуществляется при указании в программе её названия.

Ниже описаны основные стековые операции в виде (stack_before -- stack_after) с некоторыми комментариями.

* ```+``` - (n1 n2 -- n2+n1)
* ```-``` - (n1 n2 -- n2-n1)
* ```*``` - (n1 n2 -- n2*n1)
* ```/``` - (n1 n2 -- n2/n1)
* ```=```, ```>```, ```<``` - заменить два верхних элемента стека единицей, если для них условие сравнение истинно,
  иначе - нулём
* ```invert``` - если элемент на вершине стека равен нулю, заменить его единицей, иначе - нулём
* ```mod``` - (n1 n2 -- n2%n1)
* ```drop``` - (n1 -- )
* ```swap``` - (n1 n2 -- n2 n1)
* ```over``` - (n1 n2 -- n1 n2 n1)
* ```dup``` - (n1 -- n1 n1) -
* ```key``` - ( -- n1) - ожидание ввода
* ```.``` - (n1 n2 -- ) - вывести значение n1 в IO порт n2
* ```omit``` - (n1 n2 -- ) - вывести ASCII символ с кодом n1 в IO порт n2
* ```read``` - (n1 -- n2) - прочитать значение с порта n1 и положить на стек
* ```!``` - (n1 n2 -- ) - записать значение n1 в ячейку памяти n2
* ```@``` - (n1 -- n2) - прочитать значение из ячейки памяти n1 и положить его на стек

Условный оператор ```if``` выполняется в зависимости от истинности значения на вершине стека.
Истинным значением является любое целое числа за исключением 0. Ложным значением является 0.

Оператор цикла ```do loop``` выполняет ```K``` итераций в зависимости от двух значений на вершине стека (n1 n2);
```K = n1 - n2```. Внутри конструкции ```do loop``` возможно использовать
переменную ```i```, ```i = n2 + <номер итерации>```.
Аналогично конструкции ```for (i = n2; i < n1; i++) {}``` в алгоритмическом языке программирования

Оператор цикла ```begin until``` выполняет итерации до момента, когда на вершине стека
по достижению конструкции until не будет лежать истинное значение (отличное от нуля).

Оператор объявления переменной ```variable``` создаёт переменную и сопоставляет ей 
определенную ячейку памяти, взаимодействовать с которой возможно при помощи ```!``` и ```@```.
В случае добавления ключевого слова ```allot``` выделяется непрерывный участок памяти с фиксированным
в программе размером.

Комментарием в языке является строка вида ```\[^\n]```: любые символы в строке после \ трактуются как комментарии.

Используемые литералы:

* строковые литералы - имеют вид " <строка>", используются для экранизации текста после оператора ```.```
* целочисленные литералы - являются полноценным словом в программе и необходимы для того, чтобы положить конкретное
  значение на вершину стека, диапазон значений - $[-2^{32}, 2^{32} - 1]$

Память под стек и для данных выделяется статически при запуске программы.
